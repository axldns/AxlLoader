<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0014)about:internet -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"> 
   
    <head>
      
        <script type="text/javascript">
        var oldConsole = console;
        var console = {};
        var bridge;
        var swfnobridge;
        var flashParent;

        // FROM BRIDGE TO JS to bridge
        function getBridgeLoadingParams()
        {
          /*
          public const coppyOfCurrent:int = -1;
          public const current:int = 0;
          public const separated:int = 1;
          public const loaderOwnerDomain:int = 2;
          public const copyOfLoaderOwnerDomain:int = 3;

         ll.domainType = 1;
          ll.handleUncaughtErrors = false;
          ll.unloadOnErrors = false;
          ll.stopErrorPropagation = false;
          ll.preventErrorDefaults = false;
          ll.allowscriptaccess = true;
          ll.contextParameters = {};

          */
          var p = {};
              p.domainType = 1;
              p.handleUncaughtErrors = true;
              p.unloadOnErrors = true;
              p.stopErrorPropagation = false;
              p.preventErrorDefaults = false;
              p.allowscriptaccess = true;
             
              return p;
        }

       
        // FROM BRIDGE TO PROMOLOADER
        function init()
        {
          bridge = document.getElementById("bridge-content");
          flashParent = bridge.parentNode;

          promoloaderAPI.log("INIT");
          console.log = promoloaderAPI.log;
        }

        function promoLog()
        {
           if(this['promoloaderAPI'])
            {
              promoloaderAPI.log.apply(null,Array.prototype.slice.call(arguments));
            }
            // oldConsole.log(arguments);
        }

        // FROM BRIDGE TO JS
        function bridgeCantTakeIt(url,params)
        {
            promoLog("bridgeCantTakeIt",0);
            addAttribute(document.getElementById('btn-console'), 'disabled', 'true');
            // create new 
            swfnobridge = createSwfNoBridge(url,params);
            //REPLAC
            if(!flashParent)
            {
               bridge = document.getElementById("bridge-content");
              flashParent = bridge.parentNode;
            }
            flashParent.replaceChild(swfnobridge,bridge);
        }

        // FROM PROMOLOADER TO BRIDGE
        function loadswf(swfurl,params)
        {
           document.getElementById('bridge').bridgeAPI("bridge_load", swfurl,params);
        }

        // FROM LOADED SWF TO JS to promoloader
        function getParam(param)
        {
          return promoloaderAPI.getParam(param);
        }
        // FROM HTML TO BRIDGE
        function toggleBridgeConsole()
        {
            document.getElementById('bridge').bridgeAPI("bridge_toggleConsole");
        }
        

        function createSwfNoBridge(url,params)
        {
            var div = createWithAttributes("div", ["name","swf-no-bridge"]);
            var obj = createWithAttributes("object", ["type","application/x-shockwave-flash","id","swfnobridge","align","middle","width",910,"height",610]);
            if(typeof params == "string")
            {
              params = JSON.parse(params);
            }
            for(var p in params)
            {
              var par = createWithAttributes('param', [p ,params[p]] );
              obj.appendChild(par);
            }
            addAttribute(obj,'data',url);
            div.appendChild(obj);
            return div;
        }

        function quickReoload()
        {
          promoLog("quick reoload");
          flashParent.removeChild(swfnobridge);
          flashParent.appendChild(swfnobridge);
        }
        // ----------------------- LIB ------------------- //
        function addAttribute(target, key, val)
        {
          var atrib = document.createAttribute(key);
          atrib.value = val;
          target.setAttributeNode(atrib);
        }
        function createWithAttributes(ele, arr)
        {
          var elem = document.createElement(ele);
          var l = arr.length;
          var atrname, atrval;
          for(var i = 0; i < l;)
          {
            atrname = arr[i++];
            atrval = arr[i++];
            addAttribute(elem, atrname, atrval);
          }
          return elem;
        }
        </script>
    </head>
    <body>
      <!-- HTML TO JS -->
      <button onClick="quickReoload()">quick reload</button> 
      <!-- HTML TO BRIDGE -->
      <button id='btn-console' onClick="toggleBridgeConsole()">console</button> 
     
     <!-- BRIDGE OBJECT -->
      <div id='bridge-content'>
        <object  type="application/x-shockwave-flash" id="bridge" name="bridge" align="middle" data="file:///C:/Users/ddd/Desktop/Bridge.swf" width="910" height="610">
            <param name="quality" value="high"/>
            <param name="bgcolor" value="#000000"/>
            <param name="allowscriptaccess" value="always"/>
            <param name="allowfullscreen" value="true"/>
        </object>
      </div>
   </body>
</html>
